var ready=function(){var t=jj("#user-video"),e=jj("#selfie"),a=jj("#start-camera"),n=jj("#shutter"),r=jj("#remove-selfie"),s=jj("#download-selfie"),i=jj("#controller"),c=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,o=function(){u(),t.setAttribute("class",t.getAttribute("class").replace(/\s?none/g,"")),i.setAttribute("class",i.getAttribute("class").replace(/\s?none/g,""))},l=function(){var e=jj("#selfie-store"),a=e.getContext("2d"),n=t.videoWidth,r=t.videoHeight;if(n&&r){e.width=n,e.height=r,a.drawImage(t,0,0,n,r);var s=g(n,r),i=d(a,s,n,r,function(t,e){return 255-(255-e)*(255-t)/255}),c=b(i,{contrast:20,brightness:20});return a.putImageData(c,0,0),e.toDataURL("image/png")}},u=function(){i.setAttribute("class",i.getAttribute("class").replace(/\s?none/g,"")+" none"),a.setAttribute("class",a.getAttribute("class").replace(/\s?none/g,"")+" none"),t.setAttribute("class",t.getAttribute("class").replace(/\s?none/g,"")+" none"),e.setAttribute("class",e.getAttribute("class").replace(/\s?none/g,"")+" none")},g=function(t,e){var a=document.createElement("canvas"),n=a.getContext("2d");return a.width=t,a.height=e,n.fillRect(0,0,t,e),n},d=function(t,e,a,n,r){for(var s=t.getImageData(0,0,a,n),i=e.getImageData(0,0,a,n),c=0,o=i.data.length;o>c;c+=4)i.data[c+0]=r(s.data[c+0],i.data[c+0]),i.data[c+1]=r(s.data[c+1],i.data[c+1]),i.data[c+2]=r(s.data[c+2],i.data[c+2]);return i},b=function(){var t=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],e=function(t,e){var a,n,r,s=[];for(a=0;5>a;a++){for(n=0;5>n;n++)s[n]=t[n+5*a];for(n=0;5>n;n++){var i=0;for(r=0;5>r;r++)i+=e[n+5*r]*s[r];t[n+5*a]=i}}},a=function(a,n){var r,s=n.brightness||0,i=n.contrast||0,c=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1];0>i?r=127+i/100*127:(r=i%1,r=0==r?t[i]:t[i<<0]*(1-r)+t[(i<<0)+1]*r,r=127*r+127),e(c,[r/127,0,0,0,.5*(127-r),0,r/127,0,0,.5*(127-r),0,0,r/127,0,.5*(127-r),0,0,0,1,0,0,0,0,0,1]),e(c,[1,0,0,0,s,0,1,0,0,s,0,0,1,0,s,0,0,0,1,0,0,0,0,0,1]);for(var o,l,u,g,d=a.data,b=d.length,f=c[0],A=c[1],v=c[2],j=c[3],p=c[4],h=c[5],m=c[6],w=c[7],U=c[8],R=c[9],k=c[10],y=c[11],D=c[12],E=c[13],I=c[14],L=c[15],M=c[16],G=c[17],x=c[18],C=c[19],z=0;b>z;z+=4)o=d[z],l=d[z+1],u=d[z+2],g=d[z+3],d[z]=o*f+l*A+u*v+g*j+p,d[z+1]=o*h+l*m+u*w+g*U+R,d[z+2]=o*k+l*y+u*D+g*E+I,d[z+3]=o*L+l*M+u*G+g*x+C;return a};return a}();c?c.call(navigator,{video:!0},function(e){window.URL?t.src=window.URL.createObjectURL(e):t.src=e,t.onplay=function(){o()},t.play()},function(t){alert("카메라 스트림에 접근하는 과정 중 에러가 발생했습니다.")}):alert("현재 브라우저는 유저 미디어를 지원하지 않습니다."),addEvent(a,"click",function(e){t.play(),o()}),addEvent(n,"click",function(t){var a=l();e.setAttribute("src",a),e.setAttribute("class",e.getAttribute("class").replace(/\s?none/g,"")),r.setAttribute("class",r.getAttribute("class").replace(/\s?none/g,"")),s.setAttribute("class",s.getAttribute("class").replace(/\s?none/g,"")),s.setAttribute("href",a)}),addEvent(r,"click",function(t){e.setAttribute("src",""),e.setAttribute("class",e.getAttribute("class").replace(/\s?none/g,"")+" none"),r.setAttribute("class",r.getAttribute("class").replace(/\s?none/g,"")+" none"),s.setAttribute("class",s.getAttribute("class").replace(/\s?none/g,"")+" none")})};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlbGZpZS5taW4uanMiXSwibmFtZXMiOlsicmVhZHkiLCJ2aWRlbyIsImpqIiwic2VsZmllIiwic3RhcnRDYW1lcmEiLCJzaHV0dGVyIiwicmVtb3ZlU2VsZmllIiwiZG93bmxvYWRTZWxmaWUiLCJjb250cm9sbGVyIiwiZ2V0VXNlck1lZGlhIiwibmF2aWdhdG9yIiwid2Via2l0R2V0VXNlck1lZGlhIiwibW96R2V0VXNlck1lZGlhIiwibXNHZXRVc2VyTWVkaWEiLCJnZXRWaWRlbyIsImhpZGVCdXR0b25zIiwic2V0QXR0cmlidXRlIiwiZ2V0QXR0cmlidXRlIiwicmVwbGFjZSIsInRha2VQaG90byIsInN0b3JlIiwiY29udGV4dCIsImdldENvbnRleHQiLCJ3aWR0aCIsInZpZGVvV2lkdGgiLCJoZWlnaHQiLCJ2aWRlb0hlaWdodCIsImRyYXdJbWFnZSIsImdyYWRpZW50IiwiZ2VuZXJhdGVHcmFkaWVudCIsInNjcmVlbiIsImJsZW5kIiwiYm90dG9tUGl4ZWwiLCJ0b3BQaXhlbCIsImNvbG9yQ29ycmVjdGVkIiwiY29sb3JNYXRyaXgiLCJjb250cmFzdCIsImJyaWdodG5lc3MiLCJwdXRJbWFnZURhdGEiLCJ0b0RhdGFVUkwiLCJmaWx0ZXIiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJmaWxsUmVjdCIsImJhY2tncm91bmQiLCJmb3JlZ3JvdW5kIiwidHJhbnNmb3JtIiwiYm90dG9tIiwiZ2V0SW1hZ2VEYXRhIiwidG9wIiwiaSIsInNpemUiLCJkYXRhIiwibGVuZ3RoIiwiREVMVEFfSU5ERVgiLCJtdWx0aXBseSIsImEiLCJiIiwiaiIsImsiLCJjb2wiLCJ2YWwiLCJpbWFnZURhdGEiLCJvcHRpb25zIiwieCIsIm1hdHJpeCIsInIiLCJnIiwibCIsIm0wIiwibTEiLCJtMiIsIm0zIiwibTQiLCJtNSIsIm02IiwibTciLCJtOCIsIm05IiwibTEwIiwibTExIiwibTEyIiwibTEzIiwibTE0IiwibTE1IiwibTE2IiwibTE3IiwibTE4IiwibTE5IiwiY2FsbCIsInN0cmVhbSIsIndpbmRvdyIsIlVSTCIsInNyYyIsImNyZWF0ZU9iamVjdFVSTCIsIm9ucGxheSIsInBsYXkiLCJlcnIiLCJhbGVydCIsImFkZEV2ZW50IiwiZSIsInNuYXAiXSwibWFwcGluZ3MiOiJBQUFBLEdBQUlBLE9BQVEsV0FDVixHQUFJQyxHQUFRQyxHQUFHLGVBQ1hDLEVBQVNELEdBQUcsV0FDWkUsRUFBY0YsR0FBRyxpQkFDakJHLEVBQVVILEdBQUcsWUFDYkksRUFBZUosR0FBRyxrQkFDbEJLLEVBQWlCTCxHQUFHLG9CQUNwQk0sRUFBYU4sR0FBRyxlQUVoQk8sRUFBZUMsVUFBVUQsY0FBZ0JDLFVBQVVDLG9CQUFzQkQsVUFBVUUsaUJBQW1CRixVQUFVRyxlQUVoSEMsRUFBVyxXQUNiQyxJQUNBZCxFQUFNZSxhQUFhLFFBQVNmLEVBQU1nQixhQUFhLFNBQVNDLFFBQVEsV0FBWSxLQUM1RVYsRUFBV1EsYUFBYSxRQUFTUixFQUFXUyxhQUFhLFNBQVNDLFFBQVEsV0FBWSxNQUdwRkMsRUFBWSxXQUNkLEdBQUlDLEdBQVFsQixHQUFHLGlCQUNYbUIsRUFBVUQsRUFBTUUsV0FBVyxNQUUzQkMsRUFBUXRCLEVBQU11QixXQUNkQyxFQUFTeEIsRUFBTXlCLFdBRW5CLElBQUlILEdBQVNFLEVBQVEsQ0FDbkJMLEVBQU1HLE1BQVFBLEVBQ2RILEVBQU1LLE9BQVNBLEVBRWZKLEVBQVFNLFVBQVUxQixFQUFPLEVBQUcsRUFBR3NCLEVBQU9FLEVBR3RDLElBQUlHLEdBQVdDLEVBQWlCTixFQUFPRSxHQUduQ0ssRUFBU0MsRUFBTVYsRUFBU08sRUFBVUwsRUFBT0UsRUFBUSxTQUFVTyxFQUFhQyxHQUMxRSxNQUFPLE1BQU8sSUFBTUEsSUFBYSxJQUFNRCxHQUFlLE1BR3BERSxFQUFpQkMsRUFBWUwsR0FBVU0sU0FBVSxHQUFJQyxXQUFZLElBSXJFLE9BSEFoQixHQUFRaUIsYUFBYUosRUFBZ0IsRUFBRyxHQUdqQ2QsRUFBTW1CLFVBQVUsZUFJdkJ4QixFQUFjLFdBQ2hCUCxFQUFXUSxh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R0FBT2xGLEdBRVhoQixHQUFPYSxhQUFhLE1BQU9xRixHQUMzQmxHLEVBQU9hLGFBQWEsUUFBU2IsRUFBT2MsYUFBYSxTQUFTQyxRQUFRLFdBQVksS0FFOUVaLEVBQWFVLGFBQWEsUUFBU1YsRUFBYVcsYUFBYSxTQUFTQyxRQUFRLFdBQVksS0FDMUZYLEVBQWVTLGFBQWEsUUFBU1QsRUFBZVUsYUFBYSxTQUFTQyxRQUFRLFdBQVksS0FFOUZYLEVBQWVTLGFBQWEsT0FBUXFGLEtBS3RDRixTQUFTN0YsRUFBYyxRQUFTLFNBQVU4RixHQUN4Q2pHLEVBQU9hLGFBQWEsTUFBTyxJQUMzQmIsRUFBT2EsYUFBYSxRQUFTYixFQUFPYyxhQUFhLFNBQVNDLFFBQVEsV0FBWSxJQUFNLFNBRXBGWixFQUFhVSxhQUFhLFFBQVNWLEVBQWFXLGFBQWEsU0FBU0MsUUFBUSxXQUFZLElBQU0sU0FDaEdYLEVBQWVTLGFBQWEsUUFBU1QsRUFBZVUsYUFBYSxTQUFTQyxRQUFRLFdBQVksSUFBTSIsImZpbGUiOiJzZWxmaWUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHJlYWR5ID0gZnVuY3Rpb24gKCkge1xuICB2YXIgdmlkZW8gPSBqaignI3VzZXItdmlkZW8nKSxcbiAgICAgIHNlbGZpZSA9IGpqKCcjc2VsZmllJyksXG4gICAgICBzdGFydENhbWVyYSA9IGpqKCcjc3RhcnQtY2FtZXJhJyksXG4gICAgICBzaHV0dGVyID0gamooJyNzaHV0dGVyJyksXG4gICAgICByZW1vdmVTZWxmaWUgPSBqaignI3JlbW92ZS1zZWxmaWUnKSxcbiAgICAgIGRvd25sb2FkU2VsZmllID0gamooJyNkb3dubG9hZC1zZWxmaWUnKSxcbiAgICAgIGNvbnRyb2xsZXIgPSBqaignI2NvbnRyb2xsZXInKTtcblxuICB2YXIgZ2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLmdldFVzZXJNZWRpYSB8fCBuYXZpZ2F0b3Iud2Via2l0R2V0VXNlck1lZGlhIHx8IG5hdmlnYXRvci5tb3pHZXRVc2VyTWVkaWEgfHwgbmF2aWdhdG9yLm1zR2V0VXNlck1lZGlhO1xuXG4gIHZhciBnZXRWaWRlbyA9IGZ1bmN0aW9uICgpIHtcbiAgICBoaWRlQnV0dG9ucygpO1xuICAgIHZpZGVvLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCB2aWRlby5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykucmVwbGFjZSgvXFxzP25vbmUvZywgJycpKTtcbiAgICBjb250cm9sbGVyLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCBjb250cm9sbGVyLmdldEF0dHJpYnV0ZSgnY2xhc3MnKS5yZXBsYWNlKC9cXHM/bm9uZS9nLCAnJykpO1xuICB9O1xuXG4gIHZhciB0YWtlUGhvdG8gPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHN0b3JlID0gamooJyNzZWxmaWUtc3RvcmUnKSxcbiAgICAgICAgY29udGV4dCA9IHN0b3JlLmdldENvbnRleHQoJzJkJyk7XG5cbiAgICB2YXIgd2lkdGggPSB2aWRlby52aWRlb1dpZHRoLFxuICAgICAgICBoZWlnaHQgPSB2aWRlby52aWRlb0hlaWdodDtcblxuICAgIGlmICh3aWR0aCAmJiBoZWlnaHQpIHtcbiAgICAgIHN0b3JlLndpZHRoID0gd2lkdGg7XG4gICAgICBzdG9yZS5oZWlnaHQgPSBoZWlnaHQ7XG5cbiAgICAgIGNvbnRleHQuZHJhd0ltYWdlKHZpZGVvLCAwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcblxuICAgICAgLyoqKioqL1xuICAgICAgdmFyIGdyYWRpZW50ID0gZ2VuZXJhdGVHcmFkaWVudCh3aWR0aCwgaGVpZ2h0KTtcbiAgICAgIC8vIGNvbnRleHQuZHJhd0ltYWdlKGdyYWRpZW50LmNhbnZhcywgMCwgMCk7XG5cbiAgICAgIHZhciBzY3JlZW4gPSBibGVuZChjb250ZXh0LCBncmFkaWVudCwgd2lkdGgsIGhlaWdodCwgZnVuY3Rpb24gKGJvdHRvbVBpeGVsLCB0b3BQaXhlbCkge1xuICAgICAgICByZXR1cm4gMjU1IC0gKDI1NSAtIHRvcFBpeGVsKSAqICgyNTUgLSBib3R0b21QaXhlbCkgLyAyNTU7XG4gICAgICB9KVxuXG4gICAgICB2YXIgY29sb3JDb3JyZWN0ZWQgPSBjb2xvck1hdHJpeChzY3JlZW4sIHsgY29udHJhc3Q6IDIwLCBicmlnaHRuZXNzOiAyMCB9KTtcbiAgICAgIGNvbnRleHQucHV0SW1hZ2VEYXRhKGNvbG9yQ29ycmVjdGVkLCAwLCAwKTtcbiAgICAgIC8qKioqKi9cblxuICAgICAgcmV0dXJuIHN0b3JlLnRvRGF0YVVSTCgnaW1hZ2UvcG5nJyk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBoaWRlQnV0dG9ucyA9IGZ1bmN0aW9uICgpIHtcbiAgICBjb250cm9sbGVyLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCBjb250cm9sbGVyLmdldEF0dHJpYnV0ZSgnY2xhc3MnKS5yZXBsYWNlKC9cXHM/bm9uZS9nLCAnJykgKyAnIG5vbmUnKTtcbiAgICBzdGFydENhbWVyYS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgc3RhcnRDYW1lcmEuZ2V0QXR0cmlidXRlKCdjbGFzcycpLnJlcGxhY2UoL1xccz9ub25lL2csICcnKSArICcgbm9uZScpO1xuICAgIHZpZGVvLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCB2aWRlby5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykucmVwbGFjZSgvXFxzP25vbmUvZywgJycpICsgJyBub25lJyk7XG4gICAgc2VsZmllLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCBzZWxmaWUuZ2V0QXR0cmlidXRlKCdjbGFzcycpLnJlcGxhY2UoL1xccz9ub25lL2csICcnKSArICcgbm9uZScpO1xuICB9O1xuXG4gIC8qKioqKi9cblxuICB2YXIgZ2VuZXJhdGVHcmFkaWVudCA9IGZ1bmN0aW9uICh3aWR0aCwgaGVpZ2h0KSB7XG4gICAgdmFyIGZpbHRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgIHZhciBjb250ZXh0ID0gZmlsdGVyLmdldENvbnRleHQoJzJkJyk7XG5cbiAgICBmaWx0ZXIud2lkdGggPSB3aWR0aDtcbiAgICBmaWx0ZXIuaGVpZ2h0ID0gaGVpZ2h0O1xuXG4gICAgLy8gdmFyIGdyYWRpZW50ID0gY29udGV4dC5jcmVhdGVSYWRpYWxHcmFkaWVudCh3aWR0aCAvIDIsIGhlaWdodCAvIDIsIDAsIHdpZHRoIC8gMiwgaGVpZ2h0IC8gMiwgd2lkdGggKiAwLjYpO1xuXG4gICAgLy8gZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDAsICcjODA0ZTBmJyk7XG4gICAgLy8gZ3JhZGllbnQuYWRkQ29sb3JTdG9wKDEsICcjM2IwMDNiJyk7XG5cbiAgICAvLyBjb250ZXh0LmZpbGxTdHlsZSA9IGdyYWRpZW50O1xuICAgIGNvbnRleHQuZmlsbFJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG5cbiAgICByZXR1cm4gY29udGV4dDtcbiAgfVxuXG4gIHZhciBibGVuZCA9IGZ1bmN0aW9uIChiYWNrZ3JvdW5kLCBmb3JlZ3JvdW5kLCB3aWR0aCwgaGVpZ2h0LCB0cmFuc2Zvcm0pIHtcbiAgICB2YXIgYm90dG9tID0gYmFja2dyb3VuZC5nZXRJbWFnZURhdGEoMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgdmFyIHRvcCAgICA9IGZvcmVncm91bmQuZ2V0SW1hZ2VEYXRhKDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuXG4gICAgZm9yICh2YXIgaSA9IDAsIHNpemUgPSB0b3AuZGF0YS5sZW5ndGg7IGkgPCBzaXplOyBpICs9IDQpIHtcbiAgICAgIHRvcC5kYXRhW2kgKyAwXSA9IHRyYW5zZm9ybShib3R0b20uZGF0YVtpICsgMF0sIHRvcC5kYXRhW2kgKyAwXSk7XG4gICAgICB0b3AuZGF0YVtpICsgMV0gPSB0cmFuc2Zvcm0oYm90dG9tLmRhdGFbaSArIDFdLCB0b3AuZGF0YVtpICsgMV0pO1xuICAgICAgdG9wLmRhdGFbaSArIDJdID0gdHJhbnNmb3JtKGJvdHRvbS5kYXRhW2kgKyAyXSwgdG9wLmRhdGFbaSArIDJdKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdG9wO1xuICB9XG5cbiAgdmFyIHNjcmVlbiA9IGZ1bmN0aW9uIChib3R0b21QaXhlbCwgdG9wUGl4ZWwpIHtcbiAgICByZXR1cm4gMSAtICgxIC0gYm90dG9tUGl4ZWwpICogKDEgLSB0b3BQaXhlbCk7XG4gIH1cblxuICB2YXIgY29sb3JNYXRyaXggPSAoZnVuY3Rpb24oKSB7XG4gICAgdmFyIERFTFRBX0lOREVYID0gW1xuICAgICAgICAwLCAgICAwLjAxLCAwLjAyLCAwLjA0LCAwLjA1LCAwLjA2LCAwLjA3LCAwLjA4LCAwLjEsICAwLjExLFxuICAgICAgICAwLjEyLCAwLjE0LCAwLjE1LCAwLjE2LCAwLjE3LCAwLjE4LCAwLjIwLCAwLjIxLCAwLjIyLCAwLjI0LFxuICAgICAgICAwLjI1LCAwLjI3LCAwLjI4LCAwLjMwLCAwLjMyLCAwLjM0LCAwLjM2LCAwLjM4LCAwLjQwLCAwLjQyLFxuICAgICAgICAwLjQ0LCAwLjQ2LCAwLjQ4LCAwLjUsICAwLjUzLCAwLjU2LCAwLjU5LCAwLjYyLCAwLjY1LCAwLjY4LFxuICAgICAgICAwLjcxLCAwLjc0LCAwLjc3LCAwLjgwLCAwLjgzLCAwLjg2LCAwLjg5LCAwLjkyLCAwLjk1LCAwLjk4LFxuICAgICAgICAxLjAsICAxLjA2LCAxLjEyLCAxLjE4LCAxLjI0LCAxLjMwLCAxLjM2LCAxLjQyLCAxLjQ4LCAxLjU0LFxuICAgICAgICAxLjYwLCAxLjY2LCAxLjcyLCAxLjc4LCAxLjg0LCAxLjkwLCAxLjk2LCAyLjAsICAyLjEyLCAyLjI1LFxuICAgICAgICAyLjM3LCAyLjUwLCAyLjYyLCAyLjc1LCAyLjg3LCAzLjAsICAzLjIsICAzLjQsICAzLjYsICAzLjgsXG4gICAgICAgIDQuMCwgIDQuMywgIDQuNywgIDQuOSwgIDUuMCwgIDUuNSwgIDYuMCwgIDYuNSwgIDYuOCwgIDcuMCxcbiAgICAgICAgNy4zLCAgNy41LCAgNy44LCAgOC4wLCAgOC40LCAgOC43LCAgOS4wLCAgOS40LCAgOS42LCAgOS44LFxuICAgICAgICAxMC4wXG4gICAgXTtcblxuICAgIHZhciBtdWx0aXBseSA9IGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICB2YXIgaSwgaiwgaywgY29sID0gW107XG5cbiAgICAgIGZvciAoaSA9IDA7IGkgPCA1OyBpKyspIHtcbiAgICAgICAgZm9yIChqID0gMDsgaiA8IDU7IGorKykge1xuICAgICAgICAgIGNvbFtqXSA9IGFbaiArIGkgKiA1XTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGogPSAwOyBqIDwgNTsgaisrKSB7XG4gICAgICAgICAgdmFyIHZhbCA9IDA7XG4gICAgICAgICAgZm9yIChrID0gMDsgayA8IDU7IGsrKykge1xuICAgICAgICAgICAgdmFsICs9IGJbaiArIGsgKiA1XSAqIGNvbFtrXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYVtqICsgaSAqIDVdID0gdmFsO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIHZhciBjb2xvck1hdHJpeCA9IGZ1bmN0aW9uIChpbWFnZURhdGEsIG9wdGlvbnMpIHtcbiAgICAgIHZhciBicmlnaHRuZXNzID0gb3B0aW9ucy5icmlnaHRuZXNzIHx8IDBcbiAgICAgIHZhciBjb250cmFzdCAgID0gb3B0aW9ucy5jb250cmFzdCAgIHx8IDBcblxuICAgICAgdmFyIG1hdHJpeCA9IFtcbiAgICAgICAgICAxLCAwLCAwLCAwLCAwLFxuICAgICAgICAgIDAsIDEsIDAsIDAsIDAsXG4gICAgICAgICAgMCwgMCwgMSwgMCwgMCxcbiAgICAgICAgICAwLCAwLCAwLCAxLCAwLFxuICAgICAgICAgIDAsIDAsIDAsIDAsIDFcbiAgICAgIF07XG5cbiAgICAgIC8vIENvbnRyYXN0XG4gICAgICB2YXIgeDtcbiAgICAgIGlmIChjb250cmFzdCA8IDApIHtcbiAgICAgICAgeCA9IDEyNyArIGNvbnRyYXN0IC8gMTAwICogMTI3O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgeCA9IGNvbnRyYXN0ICUgMTtcblxuICAgICAgICBpZiAoeCA9PSAwKSB7XG4gICAgICAgICAgeCA9IERFTFRBX0lOREVYW2NvbnRyYXN0XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB4ID0gREVMVEFfSU5ERVhbKGNvbnRyYXN0PDwwKV0qKDEteCkrREVMVEFfSU5ERVhbKGNvbnRyYXN0PDwwKSsxXSAqIHg7XG4gICAgICAgIH1cblxuICAgICAgICB4ID0geCAqIDEyNyArIDEyNztcbiAgICAgIH1cblxuICAgICAgbXVsdGlwbHkobWF0cml4LCBbXG4gICAgICAgICAgeCAvIDEyNywgMCwgMCwgMCwgMC41ICogKDEyNyAtIHgpLFxuICAgICAgICAgIDAsIHggLyAxMjcsIDAsIDAsIDAuNSAqICgxMjcgLSB4KSxcbiAgICAgICAgICAwLCAwLCB4IC8gMTI3LCAwLCAwLjUgKiAoMTI3IC0geCksXG4gICAgICAgICAgMCwgMCwgMCwgMSwgMCxcbiAgICAgICAgICAwLCAwLCAwLCAwLCAxXG4gICAgICBdKTtcblxuICAgICAgLy8gQnJpZ2h0bmVzc1xuICAgICAgbXVsdGlwbHkobWF0cml4LCBbXG4gICAgICAgICAgMSwgMCwgMCwgMCwgYnJpZ2h0bmVzcyxcbiAgICAgICAgICAwLCAxLCAwLCAwLCBicmlnaHRuZXNzLFxuICAgICAgICAgIDAsIDAsIDEsIDAsIGJyaWdodG5lc3MsXG4gICAgICAgICAgMCwgMCwgMCwgMSwgMCxcbiAgICAgICAgICAwLCAwLCAwLCAwLCAxXG4gICAgICBdKTtcblxuICAgICAgLy8gQXBwbHkgRmlsdGVyXG4gICAgICB2YXIgZGF0YSA9IGltYWdlRGF0YS5kYXRhO1xuICAgICAgdmFyIGwgPSBkYXRhLmxlbmd0aDtcbiAgICAgIHZhciByLCBnLCBiLCBhO1xuICAgICAgdmFyIG0wID0gIG1hdHJpeFswXSwgIG0xID0gIG1hdHJpeFsxXSwgIG0yID0gIG1hdHJpeFsyXSwgIG0zID0gIG1hdHJpeFszXSwgIG00ID0gIG1hdHJpeFs0XTtcbiAgICAgIHZhciBtNSA9ICBtYXRyaXhbNV0sICBtNiA9ICBtYXRyaXhbNl0sICBtNyA9ICBtYXRyaXhbN10sICBtOCA9ICBtYXRyaXhbOF0sICBtOSA9ICBtYXRyaXhbOV07XG4gICAgICB2YXIgbTEwID0gbWF0cml4WzEwXSwgbTExID0gbWF0cml4WzExXSwgbTEyID0gbWF0cml4WzEyXSwgbTEzID0gbWF0cml4WzEzXSwgbTE0ID0gbWF0cml4WzE0XTtcbiAgICAgIHZhciBtMTUgPSBtYXRyaXhbMTVdLCBtMTYgPSBtYXRyaXhbMTZdLCBtMTcgPSBtYXRyaXhbMTddLCBtMTggPSBtYXRyaXhbMThdLCBtMTkgPSBtYXRyaXhbMTldO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGw7IGkgKz0gNCkge1xuICAgICAgICByID0gZGF0YVtpXTtcbiAgICAgICAgZyA9IGRhdGFbaSArIDFdO1xuICAgICAgICBiID0gZGF0YVtpICsgMl07XG4gICAgICAgIGEgPSBkYXRhW2kgKyAzXTtcbiAgICAgICAgZGF0YVtpXSA9IHIgKiBtMCArIGcgKiBtMSArIGIgKiBtMiArIGEgKiBtMyArIG00O1xuICAgICAgICBkYXRhW2kgKyAxXSA9IHIgKiBtNSArIGcgKiBtNiArIGIgKiBtNyArYSAqIG04ICsgbTk7XG4gICAgICAgIGRhdGFbaSArIDJdID0gciAqIG0xMCArIGcgKiBtMTEgKyBiICogbTEyICsgYSAqIG0xMyArIG0xNDtcbiAgICAgICAgZGF0YVtpICsgM10gPSByICogbTE1ICsgZyAqIG0xNiArIGIgKiBtMTcgKyBhICogbTE4ICsgbTE5O1xuICAgICAgfVxuICAgICAgcmV0dXJuIGltYWdlRGF0YTtcbiAgICB9XG4gICAgcmV0dXJuIGNvbG9yTWF0cml4O1xuICB9KSgpO1xuXG4gIC8qKioqKi9cblxuICBpZiAoIWdldFVzZXJNZWRpYSkge1xuICAgIGFsZXJ0KCftmITsnqwg67iM65287Jqw7KCA64qUIOycoOyggCDrr7jrlJTslrTrpbwg7KeA7JuQ7ZWY7KeAIOyViuyKteuLiOuLpC4nKTtcbiAgfSBlbHNlIHtcbiAgICBnZXRVc2VyTWVkaWEuY2FsbChuYXZpZ2F0b3IsIHtcbiAgICAgICAgdmlkZW86IHRydWVcbiAgICAgIH0sXG4gICAgICBmdW5jdGlvbiAoc3RyZWFtKSB7XG4gICAgICAgIGlmICh3aW5kb3cuVVJMKSB7XG4gICAgICAgICAgdmlkZW8uc3JjID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2aWRlby5zcmMgPSBzdHJlYW07XG4gICAgICAgIH1cblxuICAgICAgICB2aWRlby5vbnBsYXkgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICBnZXRWaWRlbygpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHZpZGVvLnBsYXkoKTtcbiAgICAgIH0sXG4gICAgICBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIGFsZXJ0KCfsubTrqZTrnbwg7Iqk7Yq466a87JeQIOygkeq3vO2VmOuKlCDqs7zsoJUg7KSRIOyXkOufrOqwgCDrsJzsg53tlojsirXri4jri6QuJyk7XG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIGFkZEV2ZW50KHN0YXJ0Q2FtZXJhLCAnY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgIHZpZGVvLnBsYXkoKTtcbiAgICBnZXRWaWRlbygpO1xuICB9KTtcblxuICBhZGRFdmVudChzaHV0dGVyLCAnY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgIHZhciBzbmFwID0gdGFrZVBob3RvKCk7XG5cbiAgICBzZWxmaWUuc2V0QXR0cmlidXRlKCdzcmMnLCBzbmFwKTtcbiAgICBzZWxmaWUuc2V0QXR0cmlidXRlKCdjbGFzcycsIHNlbGZpZS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykucmVwbGFjZSgvXFxzP25vbmUvZywgJycpKTtcblxuICAgIHJlbW92ZVNlbGZpZS5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgcmVtb3ZlU2VsZmllLmdldEF0dHJpYnV0ZSgnY2xhc3MnKS5yZXBsYWNlKC9cXHM/bm9uZS9nLCAnJykpO1xuICAgIGRvd25sb2FkU2VsZmllLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCBkb3dubG9hZFNlbGZpZS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykucmVwbGFjZSgvXFxzP25vbmUvZywgJycpKTtcblxuICAgIGRvd25sb2FkU2VsZmllLnNldEF0dHJpYnV0ZSgnaHJlZicsIHNuYXApO1xuXG4gICAgLy8gdmlkZW8ucGF1c2UoKTtcbiAgfSk7XG5cbiAgYWRkRXZlbnQocmVtb3ZlU2VsZmllLCAnY2xpY2snLCBmdW5jdGlvbiAoZSkge1xuICAgIHNlbGZpZS5zZXRBdHRyaWJ1dGUoJ3NyYycsICcnKTtcbiAgICBzZWxmaWUuc2V0QXR0cmlidXRlKCdjbGFzcycsIHNlbGZpZS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykucmVwbGFjZSgvXFxzP25vbmUvZywgJycpICsgJyBub25lJyk7XG5cbiAgICByZW1vdmVTZWxmaWUuc2V0QXR0cmlidXRlKCdjbGFzcycsIHJlbW92ZVNlbGZpZS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykucmVwbGFjZSgvXFxzP25vbmUvZywgJycpICsgJyBub25lJyk7XG4gICAgZG93bmxvYWRTZWxmaWUuc2V0QXR0cmlidXRlKCdjbGFzcycsIGRvd25sb2FkU2VsZmllLmdldEF0dHJpYnV0ZSgnY2xhc3MnKS5yZXBsYWNlKC9cXHM/bm9uZS9nLCAnJykgKyAnIG5vbmUnKTtcblxuICAgIC8vIHZpZGVvLnBsYXkoKTtcbiAgfSk7XG59O1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
